<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Cyber Yolks</title>
  <meta name="theme-color" content="#000000">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icons/icon.svg" type="image/svg+xml">
  <link rel="stylesheet" href="style.css?v=94">
</head>
<body>

<!-- Main Menu (mobile-first) -->
<section id="mainMenu" class="mainMenu" aria-label="Main menu">
  <div class="mainMenuHero" aria-hidden="true"></div>
  <div class="mainMenuFooterArt" aria-hidden="true"></div>
  <div class="mainMenuStars" aria-hidden="true"></div>
  <div class="mainMenuCard" role="presentation">
    <h1 class="mainMenuTitle" aria-label="Cyber Yolks">
      <span class="t1">CYBER</span>
      <span class="t2">YOLKS</span>
    </h1>
    <div class="mainMenuTag">Survive.</div>

    <div class="mainMenuActions" role="group" aria-label="Main menu actions">
      <button id="mainPlayBtn" class="mainMenuBtn mainMenuBtn--play" type="button">
        <span class="mmText">PLAY</span>
      </button>
      <button id="mainShopBtn" class="mainMenuBtn mainMenuBtn--shop" type="button">
        <span class="mmText">SHOP</span>
      </button>
      <button id="mainBoardBtn" class="mainMenuBtn mainMenuBtn--board" type="button">
        <span class="mmText">LEADERBOARD</span>
      </button>
      <button id="mainSettingsBtn" class="mainMenuBtn mainMenuBtn--settings" type="button">
        <span class="mmText">SETTINGS</span>
      </button>
      <button id="mainAboutBtn" class="mainMenuBtn mainMenuBtn--about" type="button">
        <span class="mmText">ABOUT</span>
      </button>
    </div>

    <div id="mainMenuMeta" class="mainMenuMeta">v1.0.0 BETA</div>
  </div>
</section>

<div id="app">
  <header id="topBar">
    <div class="brand">
      <div class="brandLockup" aria-label="Cyber Yolks">
        <div class="brandTitle">
          <span class="t1">CYBER</span>
          <span class="t2">YOLKS</span>
        </div>
        <div class="brandSub brandSub--header">Survive.</div>
      </div>
    </div>

    <div class="hudRow" role="status" aria-label="Game HUD">
      <div class="hudItem"><span class="label">LEVEL</span><span id="hudLevel">1</span></div>
      <div class="hudItem"><span class="label">TIME</span><span id="hudTime">0.00</span></div>
      <div class="hudItem">
        <span class="label" id="nextColorName"></span>
        <span class="nextWrap" id="hudNextColor">
          <canvas class="colorSwatch" id="nextColorSwatch" width="22" height="22" aria-label="Target enemy"></canvas>
        </span>
      </div>
      <div class="hudItem"><span class="label">CASH</span><span id="colorCash">0</span></div>
      <div class="hudItem hudItem--energy"><span class="label">ENERGY</span><span id="hudEnergy">100%</span></div>
    </div>

    <div class="actions">
      <button id="pauseBtn" class="topBarPauseBtn" type="button" aria-pressed="false" aria-label="Pause" title="Pause (P / ESC)">PAUSE</button>
    </div>
  </header>

  <main id="gameArea" aria-label="Game">
    <div id="gameShell">
      <canvas id="glCanvas" width="800" height="600" aria-hidden="true"></canvas>
      <canvas id="gameCanvas" width="800" height="600"></canvas>

      <div id="pauseOverlay" aria-hidden="true">PAUSED</div>
      <div id="startCountdown" class="startCountdown hidden" aria-hidden="true"></div>

      <div id="livesOverlay" aria-label="Lives"><span id="livesContainer"></span></div>

      <div id="ultButtons" aria-label="Ultimates">
        <button id="laserTopBtn" class="hidden" type="button" aria-label="Activate laser">LASER</button>
        <button id="nukeTopBtn" type="button" aria-label="Activate nuke">NUKE</button>
      </div>

      <div id="topRightHud" aria-label="Active powerups" role="status">
        <div id="activeOverlay" aria-live="polite"></div>
      </div>

      <div id="centerToast" aria-hidden="true"></div>
      <div id="riftToast" aria-hidden="true"></div>

      <div id="levelUpMessage">LEVEL UP!</div>
      <div id="flashOverlay"></div>

      <div id="desktopControlsHint">
        <span class="hintGroup">Move <kbd>←</kbd><kbd>↑</kbd><kbd>↓</kbd><kbd>→</kbd> or <kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd></span>
        <span class="hintDot">•</span>
        <span class="hintGroup">Aim <button id="aimModeBtn" class="hintToggle" type="button" aria-pressed="false" title="Toggle mouse aim">Z/X</button></span>
        <span class="hintDot">•</span>
        <span id="desktopUltStatus" class="hintGroup hintGroup--ultStatus" aria-hidden="true"></span>
        <span class="hintDot">•</span>
        <span class="hintGroup">Pause <kbd>P</kbd>/<kbd>ESC</kbd></span>
        <span class="hintDot">•</span>
        <span class="hintGroup">Connect <kbd>E</kbd></span>
      </div>
    </div>

    <!-- Touch Controls (Tablet/Phone) -->
    <div id="touchControls" aria-label="Touch controls">
      <div class="joystick" id="moveStick" aria-label="Move joystick">
        <div class="knob" id="moveKnob"></div>
      </div>
      <div id="touchUltStack" aria-label="Ultimates">
        <button id="ultBtn" class="ultBtn hidden" type="button" aria-label="Activate laser">LASER</button>
        <button id="nukeBtn" class="ultBtn ultBtn--nuke" type="button" aria-label="Activate nuke">NUKE</button>
      </div>
      <div class="joystick" id="aimStick" aria-label="Aim joystick">
        <div class="knob" id="aimKnob"></div>
      </div>
    </div>
  </main>
</div>

<div id="gameOverScreen" class="menuModalContent gameOverScreen" aria-hidden="true" role="dialog" aria-label="Game over">
  <h1>Game Over!</h1>
  <p id="stats"></p>
  <div class="gameOverActions" role="group" aria-label="Game over actions">
    <button class="mainMenuBtn mainMenuBtn--play" id="tryAgainBtn" type="button">Play Again</button>
    <button class="mainMenuBtn mainMenuBtn--about" id="goMainMenuBtn" type="button">Main Menu</button>
  </div>
</div>

<div id="pauseScreen" class="pauseScreen menuModalContent" aria-hidden="true" role="dialog" aria-label="Paused">
  <div class="pauseView pauseView--main" aria-label="Pause actions">
    <h1>Paused</h1>
    <p>Take a breather.</p>
    <div class="pauseToggles" role="group" aria-label="Pause toggles">
      <button id="pauseSoundBtn" class="miniBtn miniBtn--pause" type="button" aria-pressed="true">SOUND ON</button>
    </div>
    <div class="pauseActions" role="group" aria-label="Pause actions">
      <button class="mainMenuBtn mainMenuBtn--play" id="resumeBtn" type="button">Resume</button>
      <button class="mainMenuBtn mainMenuBtn--about" id="leaveGameBtn" type="button">Leave Game</button>
    </div>
  </div>

  <div class="pauseView pauseView--confirm" aria-label="Leave confirmation">
    <h1>Leave Game?</h1>
    <p>Are you sure? You will lose current progress.</p>
    <div class="confirmRow" role="group" aria-label="Leave confirmation">
      <button id="confirmLeaveYesBtn" class="miniBtn" type="button">Yes</button>
      <button id="confirmLeaveNoBtn" class="miniBtn miniBtn--pause" type="button">No</button>
    </div>
  </div>
</div>

<!-- Level Select Modal -->
<div id="levelSelectModal" class="modal hidden" aria-label="Level select">
  <div class="modalContent menuModalContent mainMenuPanelBg modalContent--split">
    <div class="modalHeader">
      <h2>Select Level</h2>
      <p id="levelSelectHint" style="margin-top:-6px; opacity:0.85;">Choose a starting level you have unlocked.</p>
    </div>
    <div class="modalBody">
      <div id="levelSelectGrid" class="levelSelectGrid" role="group" aria-label="Level buttons"></div>
    </div>
    <div class="modalFooter">
      <button class="closeBtn" id="closeLevelSelectBtn" type="button">Back</button>
    </div>
  </div>
</div>

<!-- Settings Modal -->
<div id="settingsModal" class="modal hidden" aria-label="Settings">
  <div class="modalContent menuModalContent modalContent--split">
    <div class="modalHeader">
      <h2>Settings</h2>
    </div>
    <div class="modalBody">
      <div class="settingsRow settingsRow--field">
        <label class="settingsLabel" for="playerNameInput">Player name</label>
        <input id="playerNameInput" class="settingsInput" type="text" maxlength="16" placeholder="Pilot" autocomplete="nickname" inputmode="text" enterkeyhint="done" />
      </div>
      <div class="settingsRow settingsRow--buttons">
        <button id="musicBtn" class="miniBtn" type="button" aria-pressed="true">MUSIC ON</button>
        <button id="settingsAimBtn" class="miniBtn miniBtn--pause settingsDesktopOnly" type="button" aria-pressed="false">AIM: Z/X</button>
      </div>

      <div class="settingsSection settingsDesktopOnly" aria-label="Desktop controls">
        <div class="settingsSectionTitle">Controls (Desktop)</div>
        <ul class="settingsList">
          <li>Move: <kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd> or <kbd>←</kbd><kbd>↑</kbd><kbd>↓</kbd><kbd>→</kbd></li>
          <li>Aim: <kbd>Z</kbd>/<kbd>X</kbd> (or enable Mouse Aim)</li>
          <li>Fire: automatic</li>
          <li>Laser: <kbd>SPACE</kbd></li>
          <li>Nuke: <kbd>SHIFT</kbd></li>
          <li>Refuel (crystal): <kbd>E</kbd> — stay inside the crystal’s <strong>energy field</strong> to recharge</li>
          <li>Pause: <kbd>P</kbd> / <kbd>ESC</kbd></li>
        </ul>
      </div>

      <div class="settingsSection settingsTouchOnly" aria-label="Touch controls">
        <div class="settingsSectionTitle">Controls (Mobile/Tablet)</div>
        <ul class="settingsList">
          <li>Move: use the <strong>left joystick</strong></li>
          <li>Aim: use the <strong>right joystick</strong></li>
          <li>Fire: automatic (you shoot while aiming)</li>
          <li>Laser / Nuke: tap the on-screen <strong>LASER</strong> / <strong>NUKE</strong> buttons</li>
          <li>Pause: tap <strong>PAUSE</strong> (top-right)</li>
          <li>Refuel: <strong>touch the crystal asteroid</strong> and hold still until it connects</li>
          <li>While refueling: stay inside the crystal’s <strong>energy field</strong> to keep charging</li>
        </ul>
        <p class="settingsNote">Tip: If recharging aborts, stop moving for a moment and stay in contact with the crystal.</p>
      </div>
    </div>
    <div class="modalFooter">
      <button class="closeBtn" id="closeSettingsBtn" type="button">Close</button>
    </div>
  </div>
</div>

<!-- About Modal -->
<div id="aboutModal" class="modal hidden" aria-label="About">
  <div class="modalContent menuModalContent modalContent--split">
    <div class="modalHeader">
      <h2>About</h2>
    </div>
    <div class="modalBody">
    <p style="margin-top:6px; opacity:0.9; line-height:1.35;">
      Cyber Yolks is a neon arcade survival game about drifting in a command capsule, harvesting dangerous crystal energy, and fighting jelly-core entities that only become vulnerable when they start to glow.
    </p>
    <p style="margin-top:10px; opacity:0.9; line-height:1.35;">
      Survive the chaos, upgrade your systems with recovered fragments, and dive into unstable rifts for short bursts of extreme power — if the capsule holds.
    </p>

    <p style="margin-top:10px; opacity:0.9; line-height:1.35;">
      You woke up alone in the capsule — a cockpit wrapped around a failing reactor core and a half-dead nav stack. No ship around you. No rescue ping. Just a slow spin through an empty grid of debris and light.
    </p>
    <p style="margin-top:10px; opacity:0.9; line-height:1.35;">
      The first cannon wasn’t built in a hangar. It was welded together from salvage plates, cooling coils, and a lens ripped out of a survey drone. You bolted it to the capsule’s frame, routed power straight from the crystal collector, and prayed it wouldn’t crack the hull.
    </p>
    <p style="margin-top:10px; opacity:0.9; line-height:1.35;">
      Now the swarm is constant: yolk-like creatures drifting in packs, drawn to the glow of your collector and the heat of your thrusters. They don’t “hunt” like animals — they converge like a signal. You shoot, you harvest, you patch the capsule, and you survive.
    </p>

    <details style="margin-top:10px;">
      <summary style="cursor:pointer; opacity:0.92; font-weight:900; letter-spacing:0.06em; text-transform:uppercase;">Lore Excerpt</summary>
      <p style="margin-top:10px; opacity:0.9; line-height:1.35;">
        “Then the signal showed up. Should’ve ignored it. Didn’t. Ran a scan. Ship tried to answer it back.”
      </p>
      <p style="margin-top:10px; opacity:0.9; line-height:1.35;">
        “The collector lit the cockpit like a second sun. That’s when the first yolks appeared — not from behind an asteroid, not from a gate… just there. Like the void had been waiting for me to turn the lights on.”
      </p>
      <p style="margin-top:10px; opacity:0.9; line-height:1.35;">
        “I built the cannon in zero-g with one hand in a suit glove and the other holding the capsule together. Every shot is a trade: heat for time, noise for distance, light for attention.”
      </p>
    </details>
    </div>
    <div class="modalFooter">
      <button class="closeBtn" id="closeAboutBtn" type="button">Close</button>
    </div>
  </div>
</div>

<!-- Shop Modal -->
<div id="shopModal" class="modal hidden">
  <div class="modalContent menuModalContent modalContent--split">
    <div class="modalHeader">
      <h2>Shop</h2>
      <p style="margin-top:-6px; opacity:0.9;">Color Cash: <span id="shopCash">0</span></p>
    </div>

    <div class="modalBody">
      <div class="shopSection">
        <div class="shopSectionTitle">Ultimates</div>
        <div class="ultSelect" role="group" aria-label="Ultimate purchases">
          <button id="ultLaserBtn" class="miniBtn" type="button">BUY LASER (500 CC)</button>
          <button id="ultNukeBtn" class="miniBtn" type="button">BUY NUKE (1500 CC)</button>
        </div>
        <div class="shopHint">Laser cooldown: <strong>30s</strong>. Nuke cooldown: <strong>60s</strong>. Laser uses <strong>Space</strong>. Nuke uses <strong>Shift</strong>.</div>
      </div>

      <div id="trophyGrid" class="trophyGrid"></div>
    </div>
    <div class="modalFooter">
      <button class="closeBtn" id="closeShopBtn" type="button">Close</button>
    </div>
  </div>
</div>

<!-- Leaderboard Modal -->
<div id="boardModal" class="modal hidden">
  <div class="modalContent menuModalContent modalContent--split">
    <div class="modalHeader">
      <h2>Leaderboard</h2>
      <p class="boardHint">Best runs by survival time.</p>
    </div>
    <div class="modalBody">
      <ol id="scoreList" class="scoreList"></ol>
    </div>
    <div class="modalFooter">
      <button class="closeBtn" id="closeBoardBtn" type="button">Close</button>
    </div>
  </div>
</div>

<!-- Import map required for Three.js example modules that import from "three" -->
<script type="importmap">
{
  "imports": {
    "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
    "three/examples/jsm/": "https://unpkg.com/three@0.160.0/examples/jsm/"
  }
}
</script>

<script type="module" src="js/main.js"></script>

</body>
</html>
